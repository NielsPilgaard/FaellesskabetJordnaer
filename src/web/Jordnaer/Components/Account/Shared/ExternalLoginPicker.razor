@using Microsoft.AspNetCore.Authentication

@inject SignInManager<ApplicationUser> SignInManager
@inject IdentityRedirectManager RedirectManager
@if (_externalLogins.Length == 0)
{
	<div>
		<p>
			Der er ingen eksterne login tjenester konfigureret.
		</p>
	</div>
}
else
{
	<form class="form-horizontal" action="Account/PerformExternalLogin" method="post">
		<div>
			<AntiforgeryToken />
			<input type="hidden" name="ReturnUrl" value="@ReturnUrl" />
			<p>
				@foreach (var provider in _externalLogins)
				{
                    // TODO: This should be facebook/google/microsoft buttons
					<button type="submit" class="btn btn-primary" name="provider" value="@provider.Name" title="Log ind med din @provider.DisplayName-konto">@provider.DisplayName</button>
				}
			</p>
		</div>
	</form>
}


@code {
    private AuthenticationScheme[] _externalLogins = [];

    [SupplyParameterFromQuery]
    private string? ReturnUrl { get; set; }

    protected override async Task OnInitializedAsync()
    {
        _externalLogins = (await SignInManager.GetExternalAuthenticationSchemesAsync()).ToArray();
    }
}
