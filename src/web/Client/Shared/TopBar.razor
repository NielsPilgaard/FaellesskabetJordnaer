@using Jordnaer.Client.Features.Authentication
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject NavigationManager Navigation


<MudAppBar Fixed="false" Elevation="0" Dense Style="background: var(--mud-palette-background-grey)">

    <AuthorizeView>
        <Authorized>
            <MudIconButton Icon="@Icons.Material.Filled.Menu"
                           Color="Color.Default"
                           Variant="Variant.Filled"
                           Edge="Edge.Start"
                           OnClick="@ToggleDrawer.InvokeAsync"
                           Class="mr-10"/>
        </Authorized>
    </AuthorizeView>

    @if (!_currentPageIsFrontPage)
    {
        <MudSpacer/>

        <MudLink Href="/">
            <MudImage Class="d-flex" Src="/images/mini_logo_small.png" loading="lazy" Alt="Logo" />
        </MudLink>
    }

    <MudSpacer/>

    <AuthorizeView>
        <Authorized>
            <TopBarProfileMenu/>
        </Authorized>
        <NotAuthorized>
            <MudIconButton Icon="@Icons.Material.Filled.Login" Href="auth/login" Variant="Variant.Filled" Color="Color.Tertiary"/>
        </NotAuthorized>
    </AuthorizeView>
</MudAppBar>

@code
{
    [Parameter]
    public EventCallback<bool> ToggleDrawer { get; set; }

    private bool _currentPageIsFrontPage;

    protected override void OnInitialized()
    {
        _currentPageIsFrontPage = Navigation.Uri == Navigation.BaseUri;
    }
}
